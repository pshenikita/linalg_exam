\section{Билинейные и квадратичные функции на евклиловом пространстве. Взаимно однозначное
соответствие между симметрическими билинейными формами и самосопряженными
линейными операторами. Приведение квадратичной формы к главным осям. Приведение к
диагональному виду пары форм, одна из которых положительно определена}

Пусть $V$ --- евклидово пространство. Мы знаем из теоремы 1 в вопросе 36, что отображение $x \mapsto \xi_x = (x, \bs{\cdot})$ устанавливает канонический изоморфизм $V \to V^\ast$ между $V$ и его двойственным пространством $V^\ast$. Это позволяет нам отождествить пространства линейных отображений $\Hom(V, V)$ и $\Hom(V, V^\ast)$. С другой стороны, $\Hom(V ,V)$ --- это пространство $\End(V)$ линейный операторов, а в силу теоремы 2 в вопросе 25, $\Hom(V, V^\ast)$ --- это пространство билинейных функций $\operatorname{B}(V)$. Если вникнуть в построение изоморфизмов, то мы увидим, что в явном виде канонический изоморфизм между пространством операторов и пространством билинейных функций описывается следующим утверждением, которое легко доказать и непосредственно:

\begin{proposal}
    Пусть $V$ --- евклидово пространство. Отображение $\A \mapsto \B_\A \vcentcolon = (\A\bs{\cdot}, \bs{\cdot})$ устанавливает изоморфизм $\psi: \End(V) \to \operatorname{B}(V)$.
\end{proposal}

\begin{proof}
    Т.\,к. $\dim\End(V) = \dim\operatorname{B}(V) = n^2$, достаточно проверить, что $\Ker\psi = \{\O\}$. Пусть $\psi(\A) = 0$, т.\,е. $\B_\A$ --- тождественно нулевая функция. Тогда $(\A x, y) = 0$ $\forall x, y \in V$. В частности, $(\A x, \A x) = 0$ $\forall x \in V$, т.\,е. $\A x = \bs{0}$ $\forall x \in V$ и $\A = \O$ --- нулевой оператор.
\end{proof}

Это утверждение имеет важные следствия: оно позволяет переводить утверждения об операторах в утверждения о билинейных функциях и наоборот. Одно из основных приложений заключается в следующем:

\begin{theorem}
    Для билинейной симметрической функции в евклидовом пространстве существует ортонормированный базис, в котором её матрица диагональна. Другими словами, квадратичная форма приводится к диагональму виду ортогональным преобразованием.
\end{theorem}

\smallskip
\noindent{\bfseries Первое доказательство.}
Пусть $\B$ --- симметрическая билинейная функция функция и $\A$ --- соответствующий ей оператор, т.\,е. $\B = \B_\A$. Тогда из $\B(x, y) = \B(y, x)$ получаем $(\A x, y) = (\A y, x) = (x, \A y)$, т.\,е. оператор $\A$ самосопряжён. Выберем ортонормированный базис $e_1, \ldots, e_n$ из собственных векторов оператора $\A$, т.\,е. $\A e_i = \lambda_ie_i$. Тогда для марицы $B = (b_{ij})$ функции $\B$ в этом базисе имеем
\[
    b_{ij} = \B(e_i, e_j) = (\A e_i, e_j) = (\lambda_ie_i, e_j) = \lambda_i\delta_{ij},
\]
т.\,е. матрица $B$ диагональна (и совпадает с матрицей оператора $\A$).
\hfill$\blacksquare$\par\smallskip

\smallskip
\noindent{\bfseries Второе доказательство.}
Посмотрим, как преобразуется матрица билинейной функции и матрица оператора при ортогональном преобразовании. Пусть $B$ --- матрица билинейной функции в некотором ортонормированном базисе. При ортогональном преобразовании с матрицей $C$ матрица $B$ переходит в матрицу $B^\prime = C^tBC$. Т.\,к. матрица $C$ ортогональна, то же преобразование мы можем записать в виде $B^\prime = C^{-1}BC$. Но это --- закон преобразования для матрицы оператора. Т.\,к. оператор с симметричной матрицей $B$ в ортонормированном базисе самосопряжён, его можно привести к диагональному виду ортогональным преобразованием.
\hfill$\blacksquare$\par\smallskip

Диагональный вид, к которому приводится симметрическая билинейная функция (квадратичная форма) ортогональным преобразованием, называется \textit{каноническим}.

\begin{proposal}
    Канонический вид симметрической билинейной функции (квадратичной формы) единственный с точностью до перестановки диагональных элементов. Эти элементы представляют собой собственные значения матрицы квадратичной формы в любом ортонормированном базисе.
\end{proposal}

\begin{proof}
    Пусть $Q$ -- матрица квадратичной формы в ортонормированном базисе. Тогда диагональные элементы канонического вида --- это собственные значения самосопряжённого оператора с матрицей $Q$, т.\,е. корни уравнения $\det(Q - tE) = 0$. В другом ортонормированном базисе матрица квадратичной формы есть $Q^\prime = C^tQC$ и её собственные значения находятся из уравнения $\det(Q^\prime - tE) = 0$. Т.\,к.
    \[
        \det(Q^\prime - tE) = \det(C^tQC - tC^tC) = \det(C^t(Q - tE)C) = \det(C^tC)\det(Q - tE) = \det(Q - tE),
    \]
    собственные значения матриц $Q$ и $Q^\prime$ совпадают.
\end{proof}

Модификация последней теоремы позволяет одновременно приводить к диаональному виду сразу две квадратичные формы, одна из которых положительно определена:

\begin{theorem}
    Пусть даны две квадратичные формы $Q(x)$ и $B(x)$, причём форма $Q(x)$ положительно определена. Тогда существует линейная замена координат $x = Cy$, приводящая форму $Q(x)$ к нормальному виду $(y^1)^2 + \ldots + (y^n)^2$, а форму $B(x)$ --- к диагональному виду $\lambda_1(y^1)^2 + \ldots + \lambda_n(y^n)^2$.
\end{theorem}

\begin{proof}
    Положительно определённая симметрическая билинейная функция, соответствующая квадратичной форме $Q(x)$, превращает $V$ в евклидово пространство. В исходных координатах матрица Грама скалярного произведения есть $Q$. В любом ортонормированном базисе матрица Грама (она же матрица квадратичной формы $Q(x)$) будет единичной. Согласно последней теореме, существует ортонормированный базис, в котором матрица формы $B(x)$ имеет диагональный вид.
\end{proof}

Обратим внимание, что матрица $C$ замены координат из предыдущей теоремы не является ортогональной: вместо соотношения $C^tC = E$ она удовлетворяет соотношению $C^tQC = E$. Другими словами, столбцы матрицы $C$ образуют ортонормированный базис относительно скалярного произведения в $\R^n$ с матрицей Грама $Q$.

Достаточно эффективный алгоритм приведения пары квадратичных форм, одна из которых положительно определена, к диагональному виду, основан на следующем определении.

\begin{definition}
    Пусть даны две квадратичные формы $Q(x)$ и $B(x)$, причём $Q(x)$ положительно определена. Корни уравнения $\det(B - tQ) = 0$ называются \textit{собственными значениями пары форм $Q(x)$ и $B(x)$}.
\end{definition}

Пусть $\lambda$ --- собственное значение пары форм $Q(x)$ и $B(x)$. Ненулевой вектор $y$, удовлетворяющий системе уравнений $(B - \lambda Q)y = 0$, называется \textit{собственным вектором пары форм}, соответствующим собственному значению $\lambda$.

\begin{theorem}
    Предположим, что линейная замена $x = Cy$ приводит положительно определённую форму $Q(x)$ к нормальному виду $(y^1)^2 + \ldots + (y^n)^2$, а форму $B(x)$ --- к диагональному виду $\lambda_1(y^1)^2 + \ldots + \lambda_n(y^n)^2$. Тогда числа $\lambda_1, \ldots, \lambda_n$ суть собственные векторы пары форм $Q(x)$ и $B(x)$, а столбцы матрицы $C$ образуют базис из собственных векторов пары форм, который является ортонормированным относительно скалярного произведения, задаваемого формой $Q(x)$.
\end{theorem}

\begin{proof}
    Мы имеем $C^tQC = E$, а $C^tBC = D$, где $D$ --- диагональная матрица с числами $\lambda_1, \ldots, \lambda_n$ на диагонали. Тогда $\forall i$ матрица $D - \lambda_iE$ вырождена, следовательно,
    \[
        0 = \det(D - \lambda_iE) = \det(C^tBC - \lambda_iC^tQC) = \det(C^t(B - \lambda_iQ)C) = \det(C)^2\det(B - \lambda_iQ).
    \]

    Т.\,к. матрица $C$ невырождена, отсюда следует, что $\det(B - \lambda_iQ) = 0$, т.\,е. $\lambda_i$ --- собственое значение пары форм.

    Пусть $c_i$ --- $i$-ый столбец матрицы $C$. Из соотношения $C^t(B - \lambda_iQ)C = D - \lambda_iE$ мы получаем, что $i$-ый столбец матрицы $C^t(B - \lambda_iQ)C$ нулевой, т.\,е. $C^t(B - \lambda_iQ)c_i = 0$. Т.\,к. матрица $C$ обратима, отсюда следует, что $(B - \lambda_iQ)c_i = 0$, т.\,е. $c_i$ --- собственный вектор пары форм, отвечающий собственому значению $\lambda_i$.

    Наконец, соотношение $C^tQC = E$ выражает тот факт, что столбцы матрицы $C$ образуют ортонормированный базис относительно скалярного произведения с матрицей Грама $Q$.
\end{proof}

