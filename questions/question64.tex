\section{Кососимметрические формы. Симплектическая группа}

Пусть $\B$ --- кососимметрическая билинейная функция в пространстве над полем характеристики не $2$. Соответствующую ей кососимметрическую билинейную форму $B(x, y) = b_{ij}x^Iy^j$, где $b_{ji} = -b_{ij}$, можно представить в виде
\[
    B(x, y) = \sum_{i < j}b_{ij}(x^iy^j - x^jy^i).
\]

\begin{theorem}
    Для любой кососимметрической билинейной функции $\B$ над полем характеристики, не равной $2$, существует базис, в котором её матрица блочно-диагональная с блоками размера $1$ или $2$, причём блоки размера $1$ нулевые, а блоки размера $2$ имеют вид
    $
    \begin{pmatrix}
        0 & 1\\
        -1 & 0
    \end{pmatrix}
    $.

    Другими словами, любую кососимметрическую билинейную форму $B(x, y)$, линейной заменой координат можно привести к виду
    \[
        (x^1y^2 - x^2y^1) + (x^3y^4 - x^4y^3) + \ldots + (x^{2k - 1}y^{2k} - x^{2k}y^{2k - 1}).
    \]
\end{theorem}

\begin{proof}
    Проведём индукцию по размерности пространства $V$.

    При $\dim V = 1$ доказывать нечего, т.\,к. кососимметрическая функция нулевая (здесь пользуемся тем, что характеристика поля не равна $2$).

    Пусть $\dim V = 2$. Тогда матрица кососимметрической функции в произвольном базисе $e_1, e_2$ имеет вид
    $
    \begin{pmatrix}
        0 & b\\
        -b & 0
    \end{pmatrix}
    $, где $b = b_{12} = \B(e_1, e_2)$. Пусть $b \ne 0$ (иначе мы уже имеем два блока из нулей). Тогда в новом базисе $e_{1^\prime} = e_1$ и $e_{2^\prime} = \frac{1}{b}e_2$ мы имеем
    \[
        b_{12}^\prime = \B(e_{1^\prime}, e_{2^\prime}) = \B\br{e_1, \frac{1}{b}e_2} = \frac{1}{b}\B(e_1, e_2) = 1,
    \]
    т.\,е. матрица кососимметрической формы имеет требуемый вид
    $
    \begin{pmatrix}
        0 & 1\\
        -1 & 0
    \end{pmatrix}
    $.

    Теперь предположим, что утверждение уже доказано для пространств размерности меньше $n$, и докажем его для размерности $n$. Можно считать, что функция $\B$ не является тождественно нулевой (иначе доказывать нечего). Пусть $b_{12} = \B(e_1, e_2) \ne 0$ для некоторого базиса $e_1, \ldots, e_n$. Попытаемся заменить базисные векторы так, чтобы новые векторы $e_{1^\prime}, \ldots, e_{n^\prime}$ удовлетворяли соотношениям
    \[
        \B(e_{1^\prime}, e_{2^\prime}) = 1,\quad \B(e_{1^\prime}, e_{i^\prime}) = \B(e_{2^\prime}, e_{i^\prime}) = 0\quad\text{при $i \geqslant 3$}.\eqno(\ast)
    \]

    Новый базис будем искать в виде
    \[
        e_{1^\prime} = e_1,\quad e_{2^\prime} = ce_2,\quad e_{i^\prime} = e_i + c^1_ie_1 + c^2_{i^\prime}e_2\quad\text{при $i \geqslant 3$}.
    \]

    Подставив эти соотношения в $(\ast)$, получим $c = \frac{1}{b_{12}}$ и
    \[
        0 = \B(e_{1^\prime}, e_{i^\prime}) = \B(e_1, e_i + c^1_{i^\prime}e_1 + c^2_{i^\prime}e_2) = b_{1i} + c^2_{i^\prime}b_{12},
    \]
    откуда $c^2_{i^\prime} = -\frac{b_{1i}}{b_{12}}$. Аналогично,
    \[
        0 = \B(e_{2^\prime}, e_{i^\prime}) = \B(ce_2, e_i, c^1_{i^\prime}e_1 + c^2_{i^\prime}e_2) = c(b_{2i} - c^1_{i^\prime}b_{12}),
    \]
    откуда $c^1_{i^\prime} = \frac{b_{2i}}{b_{12}}$. Окончательно, наша замена базиса имеет вид
    \[
        e_{1^\prime} =e _1,\quad e_{2^\prime} = \frac{1}{b_{12}}e_2,\quad e_{i^\prime} = e_i + \frac{b_{2i}}{b_{12}}e_1 - \frac{b_{1i}}{b_{12}}e_2\quad\text{при $i \geqslant 3$}.
    \]

    Ввиду соотношений $(\ast)$, в новом базисе матрица билинейной функции $\B$ будем иметь вид
    \[
        B^\prime =
        \left(
            \begin{array}{cc | ccc}
                0 & 1 & 0 & \cdots & 0\\
                -1 & 0 & 0 & \cdots & 0\\
                \hline
                0 & 0 &  &  &  \\
                \vdots & \vdots &  &  \widetilde{B}^\prime &  \\
                0 & 0 &  &  &  
            \end{array}
        \right),
    \]
    где матрица $\widetilde{B}^\prime$ -- матрица билинейной функции $\B$ на подпространстве $\langle e_{3^\prime}, \ldots, e_{n^\prime}\rangle$. Т.\,к. это пространство имеет размерность $n - 2$, по предположению индукции в нём существует требуемый базис $e_{3^{\prime\prime}}, \ldots, e_{n^{\prime\prime}}$. Тогда в базисе $e_{1^\prime}, e_{2^\prime}, e_{3^{\prime\prime}}, \ldots, e_{n^{\prime\prime}}$ исходного пространства $V$ матрица кососимметрической функции $\B$ имеет требуемый вид.
\end{proof}

\begin{definition}
    Вид, описанный в последней теореме, называется \textit{нормальным видом} кососимметрической билинейной формы.
\end{definition}

\begin{corollary}
    Ранг кососимметрической билинейной функции --- чётное число; кососимметрическая билинейная функция в пространстве нечётной размерности всегда вырождена.
\end{corollary}

Ясно, что нормальный вид кососимметрической билинейной формы зависит только от её ранга, и поэтому мы получаем:

\begin{proposal}
    Две кососимметрические билинейные формы получаются друг из друга линейной заменой координат тогда и только тогда, когда их ранги совпадают.
\end{proposal}

Про приведение кососимметрической билинейной формы к каноническому виду \href{http://halgebra.math.msu.su/staff/klyachko/teaching/lin.al/SQ.PDF}{писал} Антон Александрович Клячко.

Евклидово пространство можно определить как вещественное линейное пространство с фиксированной невырожденной симметрической билинейной функцией. Аналогично вводится следующее определение.

\begin{definition}
    \textit{Симплектическим пространством} называется вещественное пространство $V$ с фиксированной невырожденной кососимметрической билинейной функцией, которая обозначается $\omega: V \times V \to \R$, $(u, v) \mapsto \omega(u, v)$.
\end{definition}

Из последнего следствия вытекает, что размерность симплектического пространства $V$ всегда чётна; мы фиксируем обозначение $\dim V = n = 2m$.

\begin{definition}
    \textit{Ортогональным дополнением} подпространства $U$ в симплектическом пространстве $V$ называется подпространство
    \[
        U^\perp \vcentcolon = \{v \in V : \omega(u, v) = 0\ \forall u \in U\}.
    \]
\end{definition}

\begin{proposal}
    Для любых подпространств $U$ и $W$ симплектического пространства $V$ имеем:
    \begin{enumerate}[nolistsep]
        \item $\dim U^\perp = n - \dim U$;
        \item $(U^\perp)^\perp = U$;
        \item $(U + W)^\perp = U^\perp \cap W^\perp$;
        \item $(U \cap W)^\perp = U^\perp + W^\perp$.
    \end{enumerate}
\end{proposal}

\begin{proof}
    \begin{enumerate}
        \item Выберем базис $e_1, \ldots, e_k$ в $U$ и дополним его до базиса $e_1, \ldots, e_n$ в $V$. Пусть в этом базисе кососимметрическая функция $\omega$ задаётся матрицей $B = (b_{ij})$, т.\,е. $\omega(e_i, e_j) = b_{ij}$. Тогда для вектора $x = x^je_j$ условие принадлежности подпространству $U^\perp$ записывается $k$ линейными уравнениями
            \[
                \omega(e_i, x) = \omega(e_i, x^je_j) = b_{ij}x^j = 0,\quad i = 1, \ldots, k.
            \]

            Матрица этой системы уравнений представляет собой $(k \times n)$-матрицу, составленную из первых $k$ строк матрицы $B$. Т.\,к. матрица $B$ невырождена (имеет ранг $n$), ранг матрицы системы равен $k$, а значит, размерность пространства решений равна $n - k = n - \dim U$, что и требовалось.
        \item Т.\,к. $\omega$ --- кососимметрическая функция, равенство $\omega(u, v) = 0$ для любых $u \in U$ и $v \in U^\perp$ означает, что $U \subseteq (U^\perp)^\perp$. Из утверждения 1 вытекает, что $\dim(U^\perp)^\perp = n - (n - \dim U) = \dim U$, поэтому $U = (U^\perp)^\perp$.
        \item Докажем, что $(U + W)^\perp \subseteq U^\perp \cap W^\perp$. Пусть $v \in (U + W)^\perp$, т.\,е. $\omega(u + w, v) = 0$ $\forall u \in U, w \in W$. Полагая $w = \bs{0}$ и $u = \bs{0}$ мы получим, соответственно, $v \in U^\perp$ и $v \in W^\perp$, откуда $v \in U^\perp \cap W^\perp$.

            Теперь докажем, что $U^\perp \cap W^\perp \subseteq (U + W)^\perp$. Пусть $v \in U^\perp \cap W^\perp$. Тогда $\omega(u, v) = 0$ $\forall u \in U$ и $\omega(w, v) = 0$ $\forall w \in W$. Следовательно. $\omega(u + w, v) = 0$, т.\,е. $v \in (U + W)^\perp$.
        \item Ясно, что $U^\perp \subseteq (U \cap W)^\perp$ и $W^\perp \subseteq (U \cap W)^\perp$, откуда $U^\perp + W^\perp \subseteq (U \cap W)^\perp$. Далее, имеем
            \begin{multline*}
                \dim(U^\perp + W^\perp) = \dim U^\perp + \dim W^\perp - \dim(U^\perp \cap W^\perp) =\\ = \dim U^\perp + \dim W^\perp - \dim(U + W)^\perp =\\ = n - \dim U + n - \dim W - n + \dim(U + W) = n - \dim(U \cap W) = \dim(U \cap W)^\perp.
            \end{multline*}
            Поэтому $(U \cap W)^\perp = U^\perp + W^\perp$.
    \end{enumerate}
\end{proof}

\begin{remark}
    Последнее предложение выполнено для произвольной невырожденной билинейной функции, но при этом необходимо различать левое и правое ортогональные дополнения.
\end{remark}

В отличие от евклидовых пространств, равенство $V = U \oplus U^\perp$ может не иметь места в симплектическом пространстве.

\begin{definition}
    Подпространство $U \subseteq V$ называется \textit{изотропным}, если $\omega\big|_U = \O$.
\end{definition}

Другими словами, $U$ изотропно, если $U \subseteq U^\perp$. Для изотропного пространства мы имеем $\dim U \leqslant \dim U^\perp = n - \dim U$, откуда $\dim U \leqslant m = \frac{n}{2}$.

\begin{definition}
    Изотропное подпространство $L$ максимальной размерности $m = \frac{\dim V}{2}$ называется \textit{лагранжевым}. Для такоого подпространства имеем $L = L^\perp$.
\end{definition}

Из теоремы о нормальном виде кососимметрической функции вытекает, что существует базис $e_1, \ldots, e_{2m}$, для которого
\[
    \omega(e_i, e_j) =
    \begin{cases}
        1,&\text{если $i$ нечётно и $j = i + 1$},\\
        0,&\text{для всех остальных $i$ и $j > i$}.
    \end{cases}
\]

Рассмотрим новый базис, получаемый перенумерацией векторов $e_1, \ldots, e_{2m}$:
\[
    a_i = e_{2i - 1},\quad b_i = e_{2i},\quad i = 1, \ldots, m.
\]

\begin{definition}
    Такой базис $a_1, \ldots, a_m, b_1, \ldots, b_m$ удовлетворяет соотношениям
    \[
        \omega(a_i, b_j) = \delta_{ij},\quad\omega(a_i, a_j) = \omega(b_i, b_j) = 0
    \]
    и называется \textit{симплектическим} или \textit{гамильтоновым} базисом.
\end{definition}

Матрица функции $\omega$ в симплектическом базисе имеет вид
$
\begin{pmatrix}
    0 & E\\
    -E & 0
\end{pmatrix}
$.

Из существования симплектического базиса сразу вытекает существование лагранжевых подпространств. Для каждого подмножества индексов $I = \{i_1, \ldots, i_k\} \subseteq \{1, \ldots, m\}$ (возможно, пустого) положим
\[
    L_I \vcentcolon = \langle a_i : i \in I, b_j : j \notin I\rangle.
\]

Ясно, что $\dim L_I = m$ и $L_I$ --- лагранжево подпространство. В частности, $L_{\{1, \ldots, m\}} = \langle a_1, \ldots, a_m\rangle$ и $L_\varnothing = \langle b_1, \ldots, b_m\rangle$.

\begin{definition}
    Лагранжевы подпространства вида $L_I$ называются \textit{стандартными} для данного симплектического базиса.
\end{definition}

\begin{lemma}
    Любое изотропное подпространство $U$ содержится в некотором лагранжевом.
\end{lemma}

\begin{proof}
    Пусть $\dim U = k$. Рассмотрим $\omega\big|_{U^\perp}$ --- ограничение кососимметрической функции $\omega$ на подпространство $U^\perp$. Т.\,к. $\omega\big|_U = \O$ и $U \subseteq U^\perp$, кососимметрическая функция $\omega\big|_{U^\perp}$ вырождена (если $U \ne \{\bs{0}\}$), а её ранг равен
    \[
        \dim U^\perp - \dim(U^\perp)^\perp = \dim U^\perp - \dim U = n - k - k = 2(m - k).
    \]

    Приведя билинейную функцию $\omega\big|_{U^\perp}$ к нормальному виду, получим, что в некотором базисе $a_1, \ldots, a_{m - k}, b_1, \ldots, b_{m - k}, c_1, \ldots, c_k$ её матрица будет иметь вид
    \[
        \begin{pmatrix}
            0 & E & 0\\
            -E & 0 & 0\\
            0 & 0 & 0
        \end{pmatrix}.
    \]

    При этом $U = \langle c_1, \ldots, c_k\rangle$. Рассмотрим $L = \langle b_1, \ldots, b_{m - k}, c_1, \ldots, c_k\rangle$. Тогда $U \subseteq L$ и $\dim L = m$. Наконец, $L$ лагранжево, т.\,к. матрица ограничения $\omega\big|_L$ есть правый нижний квадрат из нулей в матрице ограничения $\omega\big|_{U^\perp}$.
\end{proof}

\begin{theorem}
    Для любого лагранжева подпространства $L \subseteq V$ существует такое лагранжево подпространство $\widetilde{L}$, что
    \[
        V = L \oplus \widetilde{L},
    \]
    причём, подпространство $\widetilde{L}$ можно выбрать среди стандартных подпрсотранств $L_I$, отвечающих произвольному наперёд заданному симплектическому базису.
\end{theorem}

\begin{proof}
    Рассмотрим подпространство $L_{\{1, \ldots, m\}} = \langle a_1, \ldots, a_m\rangle$ и пусть $I$ --- такое подмножество индексов, что векторы $a_i$, $i \in I$, порождают в $L_{\{1, \ldots, m\}}$ подпространство, дополнительное к $L_{\{1, \ldots, m\}} \cap L$:
    \[
        (L_{\{1, \ldots, m\}} \cap L) \oplus \langle a_i : i \in I\rangle = L_{\{1, \ldots, m\}}
    \]
    (для этого нужно выбрать базис $e_1, \ldots, e_k$ в $L_{\{1, \ldots, m\}} \cap L$ и затем выбросить из семейства векторов $e_1, \ldots, e_k$, $a_1, \ldots, a_m$ все векторы, линейно выражающиеся через предыдущие). Т.\,к. $L_{\{1, \ldots, m\}} \cap L \subseteq L = L^\perp$ и $\langle a_i : i \in I\rangle \subseteq L_I = L_I^\perp$, мы имеем
    \[
        L_{\{1, \ldots, m\}} = (L_{\{1, \ldots, m\}} \cap L) \oplus \langle a_i : i \in I\rangle \subseteq L^\perp + L_I^\perp = (L \cap L_I)^\perp.
    \]
    Следовательно, $L \cap L_I \subseteq L_{\{1, \ldots, m\}}^\perp = L_{\{1, \ldots, m\}}$. Тогда
    \[
        L \cap L_I = (L \cap L_{\{1, \ldots, m\}}) \cap (L_I \cap L_{\{1, \ldots, m\}}) = (L \cap L_{\{1, \ldots, m\}}) \cap \langle a_i : i \in I\rangle = \{\bs{0}\}.
    \]
    Т.\,к. $\dim L + \dim L_I = \dim V$, мы получаем, что $V = L \oplus L_I$.
\end{proof}

\begin{definition}
    Пусть $V$ --- вещественное пространство. Скажем, что на $V$ задано \textit{обобщённое скалярное произведение}, если на $V$ задана фиксированная невырожденная билинейная функция $\B$. По аналогии с обычным скалярным произведением будем обозначать обобщённое скалярное произведение через $(x, y) \vcentcolon = \B(x, y)$.
\end{definition}

Примерами являются евклидово и симплектическое пространства.

\begin{definition}
    Оператор $\A: V \to V$ \textit{сохраняет обобщённое скалярное произведение}, если $(\A x, \A y) = (x, y)$ $\forall x, y \in V$.
\end{definition}

\begin{proposal}
    Пусть обобщённое скалярное произведение задаётся матрицей $G$ в некотором базисе. Тогда оператор, заданный матрицей $A$ в том же базисе, сохраняет обобщённое скалярное произведение тогда и только тогда, когда выполнено соотношение $A^tGA = G$.
\end{proposal}

\begin{proof}
    Пусть в базисе $e_1, \ldots, e_n$ имеем $\A e_i = a^j_ie_j$ и $g_{ij} = (e_i, e_j)$. Тогда для матриц $A = (a^j_i)$ и $G = (g_{ij})$ имеем
    \[
        (\A e_i, \A e_j) = (a^k_ie_k, a^l_je_l) = a^k_ia^l_j(e_k, e_l) = a^k_ig_{kl}a^l_j = (A^tGA)_{ij}.
    \]
    Поэтому соотношения $(\A e_i, \A e_j) = (e_i, e_j)$ для всех $i, j$ эквивалентны матричному соотношению $A^tGA = G$.
\end{proof}

\begin{proposal}
    Операторы, сохраняющие обобщённое скалярное произведение, образуют группу относительно композиции.
\end{proposal}

\begin{proof}
    Очевидно, что тождественный оператор сохраняет обобщённое скалярное произведение, и композиция операторов с этим свойство также обладает этим свойством. Кроме того, если оператор $\A$, сохраняющий скалярное произведение, обратим, то $\A^{-1}$ также сохраняет скалярное произведение:
    \[
        (\A^{-1}x, \A^{-1}y) = (\A\A^{-1}x, \A\A^{-1}y) = (x, y).
    \]

    Существование обратного оператора вытекает из соотношения $A^tGA = G$. Действительно, вычисление определителя даёт $(\det A)^2\det G = \det G$; т.\,к. матрица $G$ невырождена (потому что билинейная функция $\B$ невырождена), получаем $\det A \ne 0$.
\end{proof}

\begin{definition}
    Группа операторов, сохраняющих симплектическое скалярное произведение в $\R^{2m}$, называется \textit{симплектической группой} и обозначается $\operatorname{Sp}(2m)$. В гамильтоновом базисе матрица $A$ симплектического оператора удовлетворяет соотношению $A^tGA = G$, где
    $
    G =
    \begin{pmatrix}
        0 & E\\
        -E & 0
    \end{pmatrix}
    $ с блоками размера $m$. Такие матрицы называются \textit{симплектическими}.
\end{definition}

