\section{Ортогональный оператор, его свойства и матрица. Канонический вид матрицы ортогонального оператора}

\begin{proposal}
    Следующие условия для оператора $\A: V \to V$ в евклидовом или эрмитовом пространстве эквивалентны:
    \begin{enumerate}[nolistsep]
        \item Оператор $\A$ сохраняет длины векторов, т.\,е. $\abs{\A v} = \abs{v}$ $\forall v \in V$;
        \item Оператор $\A$ сохраняет скалярное произведение, т.\,е. $(\A u, \A v) = (u, v)$ $\forall u, v \in V$;
        \item Оператор $\A$ переводит ортонормированные базисы в ортонормированные, т.\,е. если $e_1, \ldots, e_n$ --- ортонормированный базис, то $\A e_1, \ldots, \A e_n$ --- также ортонормированный базис;
        \item Матрица $A$ оператора $\A$ в ортонормированном базисе ортогональна (унитарна), т.\,е. $A^tA = E$ (соответственно, $\overline{A}^tA = E$);
        \item $\A^\ast\A = \id$, т.\,е. сопряжённый оператор к $\A$ является его обратным.
    \end{enumerate}
\end{proposal}

\begin{proof}
    Мы докажем импликации $1 \Leftrightarrow 2$, $2 \Rightarrow 3 \Rightarrow 4 \Rightarrow 5 \Rightarrow 2$.

    $1 \Rightarrow 2$. В евклидовом пространстве имеем $(u + v, u + v) = (u, u) + 2(u, v) + (v, v)$, откуда
    \[
        (u, v) = \frac{1}{2}((u + v, u + v) - (u, u) - (v, v)).
    \]

    Поэтому если оператор сохраняет квадраты длин, т.\,е. скалярные произведения вида $(v, v)$, то он сохраняет и все скалярные произведения.

    В эрмитовом пространстве имеем $(u + v, u + v) = (u, u) + (u, v) + \overline{(u, v)} + ((v, v) = (u, u) + 2\Re(u, v) + (v, v)$, откуда
    \[
        \Re(u, v) = \frac{1}{2}((u + v, u + v) - (u, u) - (v, v))
    \]
    и, аналогично,
    \[
        \Im(u, v) = -\frac{1}{2}((u + iv, u + iv) - (u, u) - (v, v)).
    \]

    Поэтому если оператор сохраняет длины, то он сохраняет и все скалярное произведение $(u, v)$, т.\,к. он сохраняет его вещественную и мнимую части.

    $2 \Rightarrow 1$. Очевидно.

    $2 \Rightarrow 3$. Пусть $(\A u, \A v) = (u, v)$. Тогда если $e_1, \ldots, e_n$ --- ортонормированный базис, то $(\A e_i, \A e_j) = (e_i, e_j) = \delta_{ij}$, т.\,е. базис $\A e_1, \ldots, \A e_n$ также ортонормирован.
    
    $3 \Rightarrow 4$. Пусть $\A$ переводит ортоормированный базис $e_1, \ldots, e_n$ в ортонормированный $\A e_1, \ldots, \A e_n$, и $A = (a^i_j)$ --- матрица оператора в базисе $e_1, \ldots, e_n$. Тогда
    \[
        \delta_{ij} = (\A e_i, \A e_j) = (a^k_ie_k, a^\ell_je_\ell) = \overline{a}^k_ia^\ell_j(e_k, e_\ell) = \overline{a}^k_ia^\ell_j\delta_{k\ell} = \overline{a}^k_i\delta_{k\ell}a^\ell_j.
    \]
    Это эквивалентно матричному соотношение $E = \overline{A}^tEA$ или $\overline{A}^tA = E$.

    $4 \Rightarrow 5$. Это следует из предложения 1 в вопросе 37.

    $5 \Rightarrow 2$. Пусть $\A^\ast\A = \id$. Тогда $(\A u, \A v) = (\A^\ast\A u, v) = (u, v)$, т.\,е. $\A$ сохраняет скалярное произведение.
\end{proof}

\begin{definition}
    Оператор $\A: V \to V$ в евклидовом (эрмитовом) пространстве, удовлетворяющий одному из эквивалентных свойств последнего предложения, называется \textit{ортогональным} (соответственно, \textit{унитарным}).
\end{definition}

Иногда ортогональные и унитарные операторы называют \textit{изометрическими}.

Как и в случае самосопряжённых операторов, для приведения ортогонального или унитарного преобразования к каноническому виду нам понадобится утверждение об инвариантности ортогонального дополнения. Причём, эту лемму тоже будем называть <<важной>>.

\begin{lemma}[Важная]
    Пусть $\A: V \to V$ --- ортогональный или унитарный оператор, а $W \subset V$ --- инвариантное относительно $\A$ подпространство. Тогда ортогональное дополнение $W^\perp$ также инвариантно относительно $\A$.
\end{lemma}

\begin{proof}
    Пусть $u \in W^\perp$. Нам надо показать, что $\A u \in W^\perp$, т.\,е. что $(\A u, w) = 0$ $\forall w \in W$. Мы знаем, что $\A(W) \subset W$. Поскольку оператор $\A$ обратим, $\A(W) = W$. Тогда найдётся такой вектор $v \in W$, что $w = \A v$, а значит, $(\A u, w) = (\A u, \A v) = (u, v) = 0$.
\end{proof}

\begin{lemma}
    Собственные значения ортогонального (унитарного) оператора $\A$ по модулю равны $1$.
\end{lemma}

\begin{proof}
    Действительно, пусть $\A v = \lambda v$ для $v \ne \bs{0}$. Тогда
    \[
        (v, v) = (\A v, \A v) = (\lambda v, \lambda v) = \overline{\lambda}\lambda(u, v) = \abs{\lambda}^2(u, v),
    \]
    откуда $\abs{\lambda}^2 = 1$.
\end{proof}

\begin{theorem}
    Полностью аналогично доказательству теоремы 1 в вопросе 38 и теоремы 1 в приложении про косоэрмитовы операторы. Шаг индукции проводим, выбирая собственный вектор $v$ и устанавливая инвариантность подпространства $\langle v\rangle^\perp$ при помощи последней леммы.
\end{theorem}

\begin{theorem}
    Для ортогонального оператора $\A$ существует ортонормированный базис, в котором его матрица блочно-диагональная с блоками размера $1$ или $2$, причём блоки размера $1$ имеют вид $(1)$ или $(-1)$, а блоки размера $2$ имеют вид
    $
    \begin{pmatrix}
        \cos\varphi & -\sin\varphi\\
        \sin\varphi & \cos\varphi
    \end{pmatrix}
    $, где $\varphi \ne \pi k$, $k \in \Z$.
\end{theorem}

\begin{proof}
    В пространстве размерности $1$ матрица и так имеет вид $(1)$ или $(-1)$. В пространстве размерности $2$ любая ортогональная матрица имеет вид
    $
    \begin{pmatrix}
        \cos\varphi & -\sin\varphi\\
        \sin\varphi & \cos\varphi
    \end{pmatrix}
    $ (если определитель равен $1$) или
    $
    \begin{pmatrix}
        \cos\varphi & \sin\varphi\\
        \sin\varphi & -\cos\varphi
    \end{pmatrix}
    $ (если определитель равен $-1$). В первом случае мы уже имеем требуемый вид (а оператор представляет собой поворот на угол $\varphi$ в положительном направлении). Во втором случае оператор представляет собой симметрию относительно прямой под углом $\varphi / 2$ к оси абсцисс. Такой оператор имеет два ортогональный собственных вектора: $\br{\cos\frac{\varphi}{2}, \sin\frac{\varphi}{2}}$ (вектор вдоль оси симметрии) и $\br{-\sin\frac{\varphi}{2}, \cos\frac{\varphi}{2}}$ (вектор, перпендикулярный оси симметрии). В ортонормированном базисе из этих собственных векторов операторов
    $
    \begin{pmatrix}
        \cos\varphi & \sin\varphi\\
        \sin\varphi & -\cos\varphi
    \end{pmatrix}
    $ принимает требуемый вид
    $
    \begin{pmatrix}
        1 & 0
        0 & -1
    \end{pmatrix}
    $.

    Далее действуем по индукции, как и при доказательстве теоремы 2 из приложения про кососимметрические операторы. Предположим, что утверждение доказано для операторов в пространствах размерности не больше $n - 1$, и докажем его для пространства $V$ размерности $n$ (где $n \geqslant 3$).

    В силу теоремы теоремы 1 в вопросе 19 для оператора $\A$ существует одномерное или двумерное инвариантное подпрсотранство $W \subset V$. Из важной леммы следует, что ортогональное дополнение $W^\perp$ также инвариантно.

    По предположению индукции, в пространстве $W^\perp$ имеется требуемый базис для ортогонального оператора $\A\big|_{W^\perp}$. Выбрав ортонормированный базис в пространстве $W$, как описано в начале доказательства, и взял объединение базисов в $W^\perp$ и $W$, мы получим требуемый ортонормированный базис пространства $V$.
\end{proof}

Матрицы, описанные в двух последних теоремах, называются \textit{каноническим видом} унитарного и ортогонального оператора.

\begin{example}
    \begin{enumerate}
        \item Как указано в доказательстве предыдущей теоремы, ортогональный оператор с матрицей
            $
            \begin{pmatrix}
                \cos\varphi & \sin\varphi\\
                \sin\varphi & -\cos\varphi
            \end{pmatrix}
            $ имеет канонический вид
            $
            \begin{pmatrix}
                1 & 0\\
                0 & -1
            \end{pmatrix}
            $. Тот же канонический вид будет, если оператор рассматривать как унитарный.
        \item Каноническй вид ортогонального оператора с матрицей
            $
            \begin{pmatrix}
                \cos\varphi & -\sin\varphi\\
                \sin\varphi & \cos\varphi
            \end{pmatrix}
            $ --- это та же самая матрица. В то же время канонический вид этого оператора, рассматриваемого как унитарный оператор, есть
            $
            \begin{pmatrix}
                e^{i\varphi} & 0\\
                0 & e^{i\varphi}
            \end{pmatrix}
            $, где $e^{i\varphi} = \cos\varphi + i\sin\varphi$.
        \item В трёхмерном пространстве канонический вид ортогонального оператора есть
            \[
                \begin{pmatrix}
                    \cos\varphi & -\sin\varphi & 0\\
                    \sin\varphi & \cos\varphi & 0\\
                    0 & 0 & \pm 1
                \end{pmatrix},
            \]
            где в левом нижнем углу стоит $1$ или $-1$ в зависимости от знака определителя оператора. Операторы, канонический вид которых имеет три блока $(1)$ или $(-1)$, получаются при $\varphi = \pi k$. Если определитель положителен, то такой оператор представляет собой поворот (вокруг оси третьего вектора канонического базиса). Если же определитлеь отрицателен, то оператор --- это <<поворот с переворотом>>, т.\,е. композиция поворота и симметрии относительно плоскости, перпендикулярной оси поворота.

            Отсюда, в частности, следует, что композиция двух поворотов --- это снова поворот вокруг некоторой оси (т.\,к. в каноническом виде всегда происходит всего один поворот).
        \item В четырёхмерном пространстве уже бывают независимые повороты. А именно, канонический вид ортогонального оператора общего вида с положительным определителем представляет собой матрицу из двух блоков размера $2 \times 2$:
            \[
                \begin{pmatrix}
                    \cos\varphi & -\sin\varphi & 0 & 0\\
                    \sin\varphi & \cos\varphi & 0 & 0\\
                    0 & 0 & \cos\psi & -\sin\psi\\
                    0 & 0 & \sin\psi & \cos\psi
                \end{pmatrix}.
            \]

            Это композиция двух независимых поворотов: на угол $\varphi$ в плоскости первого и второго базисных векторов и на угол $\psi$ в плоскости третьего и четвёртого базисных векторов. Такой оператор не сводится к одному повороту.
    \end{enumerate}
\end{example}

Произведение ортогональных операторов, очевидно, является ортогональным оператором, и поэтому ортогональные операторы в евклидовом пространстве $V$ образуют подгруппу в общей линейной группе $\operatorname{GL}(V)$. Эта подгруппа называется \textit{ортогональной подгруппой} и обозначается $O(V) \simeq O(\dim V)$.

