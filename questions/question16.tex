\section{Диагонализируемость (матрицы) линейного оператора. Критерии диагонализируемости и достаточное условие}

\begin{definition}
    Оператор $\A$ называется \textit{диагонализируемым}, если существует базис, в котором матрица этого оператора диагональна.
\end{definition}

Базис, в котором матрица оператора диагональна, очевидно, состоит из собственных векторов. Поэтому оператор диагонализируем тогда и только тогда, когда для него существует базис из собственных векторов.

\begin{theorem}[Критерий диагонализируемости]
    Оператор $\A$ в $n$-мерном пространстве $V$ диагонализируем тогда и только тогда, когда его характеристический многочлен имеет в точности $n$ корней (с учётом кратностей), и размерность каждого собственного подпространства $V_\lambda$ равна кратности корня $\lambda$.
\end{theorem}

\begin{proof}
    Предположим, что оператор $\A$ диагонализируем. Пусть на диагонали матрицы $D$ оператора $\A$ стоят числа $\lambda_1, \ldots, \lambda_k$, причём число $\lambda_i$ присутствует ровно $r_i$ раз. Тогда мы имеем $\chi_\A(t) = \det (D - t \cdot E) = \prod\limits_{i = 1}^k(\lambda_i - t)^{r_i}$. Следовательно, многочлен $\chi_\A(t)$ имеет $n$ корней, и каждому корню $\lambda_i$ соответствует ровно $r_i$ линейно независимых собственных векторов, т.\,е. $\dim V_{\lambda_i} = r_i$.

    Предположим теперь, что многочлен $\chi_\A(t)$ имеет различные корни $\lambda_1, \ldots, \lambda_k$, причём кратность корня $\lambda_i$ равна $r_i$, $\sum\limits_{i = 1}^kr_i = n$ и $\dim V_{\lambda_i} = r_i$. Согласно следствию 1 из вопроса 13, пространства $V_{\lambda_1}, \ldots, V_{\lambda_k}$ образуют прямую сумму, а по условию сумма их размерностей равна $n = \dim V$. Следовательно, $V = V_{\lambda_1} \oplus \ldots \oplus V_{\lambda_k}$. Выбрав базис в каждом из подпространств $\{V_{\lambda_i}\}_{i = 1}^k$ и взяв объединение этих базисов, мы получим базис пространства $V$, состоящий из собственных векторов. Итак, оператор $\A$ диагонализируем.
\end{proof}

\begin{corollary}[Достаточное условие диагонализируемости]
    Если характеристический многочлен $\chi_\A(t)$ имеет $n = \dim V$ различных корней, то оператор $\A$ диагонализируем.
\end{corollary}

\begin{remark}
    Панов пишет, что набор собственных значений оператора $\A$ часто называют его \textit{спектром} (будет в курсе функционального анализа). Если все собственные значения имеют кратность $1$ как корни характеристического многочлена, то говорят о \textit{простом спектре}. Таким образом, операторы с простым спектром диагонализируемы. Появление кратных корней является <<особенностью>>, которая устраняется произвольно малым возмущением коэффициентов матрицы оператора. Поэтому над полем $\C$ <<почти все операторы диагонализируемы>>.

    К последней фразе лично я отношусь скептически, ведь (как заметил Рамиль Хакамов) любое действительное число можно произвольно малым возмущением сделать рациональным, хотя язык не повернётся сказать, что <<почти все действительные числа рациональные>>.

    UPD. Почитал, оказалось, что подмножество матриц, не являющихся диагонализируемыми над $\C^{n \times n}$, имеет нулевую меру Лебега. То есть, по факту это <<почти никакие>>. Можно ещё сказать, что диагонализируемые матрицы образуют всюду плотное подмножество в топологии Зарисского (замкнутыми называются множества нулей многочленов из некоторого выделенного множества), ведь дополнение к этому подмножеству лежит в множестве, в котором дискриминант характеристического уравнения обнуляется, т.\,е. на гиперповерхности. Над $\R$ это не выполняется.

    Если интересно почитать про геометрию дискриминанта, можно это сделать \href{https://old.mccme.ru/free-books/mmmf-lectures/book.41.pdf}{здесь}.
\end{remark}

\begin{example}
    \begin{enumerate}[nolistsep]
        \item Оператор, заданный матрицей
            $
            \begin{pmatrix}
                0 & -1\\
                1 & 0
            \end{pmatrix}
            $ в стандартном базисе в $\R^2$ не диагонализируем, т.\,к. его характеристический многочлен $t^2 + 1$ не имеет вещественных корней. Однако тот же оператор над $\C$ диагоналазируем: в базисе $f_1 = (1, i)$, $f_2 = (1, -i)$ его матрица
            $
            \begin{pmatrix}
                -i & 0\\
                0 & i
            \end{pmatrix}
            $ диагональна.
        \item Оператор, заданный матрицей
            $
            \begin{pmatrix}
                1 & 1\\
                0 & 1
            \end{pmatrix}
            $ не диагонализируем ни над каким полем по другой причине: его характеристический многочлен $(t - 1)^2$ имеет корень $1$ кратности $2$, но при этом размерность соответствующего собственного подпространства равна $1$ (вектор $e_2 = (0, 1)$ не является собственным).
    \end{enumerate}
\end{example}

