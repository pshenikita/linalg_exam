\section{Существование жорданова базиса для нильпотентного оператора (для матрицы с единственным собственным значением --- характеристическим корнем)}

\begin{definition}
    Оператор $\A$ называется \textit{нильпотентным}, если $\A^k = 0$ для некоторого $k \in \N$. Минимальное число $k$, для которого $\A^k = 0$, называется \textit{степенью нильпотентности} $\A$.
\end{definition}

\begin{example}
    Рассмотрим оператор $\A$, заданный в базисе $e_1, \ldots, e_n$ матрицей
    $
    \begin{pmatrix}
        0 & 1 & & 0\\
        \vdots & \ddots & \ddots & \\
        0 & \cdots & 0 & 1
    \end{pmatrix}
    $. Действие этого оператора на базисные векторы описывается схемой $e_n \mapsto e_{n - 1} \mapsto \ldots \mapsto e_1 \mapsto \bs{0}$. Отсюда видно, что $\A^n = 0$, т.\,е. оператор $\A$ нильпотентен и имеет степень $n$.
\end{example}

Сформулируем некоторые свойства нильпотентных операторов.

\begin{proposal}
    Пусть $\A: V \to V$ --- нильпотентный оператор, причём $\dim V = n$. Тогда
    \begin{enumerate}[nolistsep]
        \item единственным собственным значением $\A$ является $0$;
        \item $\A$ диагонализируем тогда и только тогда, когда $\A = 0$;
        \item степень нильпотентности $\A$ не превосходит $n$.
    \end{enumerate}
\end{proposal}

\begin{proof}
    \begin{enumerate}
        \item Пусть $\A^k = 0$ и $\A^{k - 1} \ne 0$. Значит, существует $v \in V: u \vcentcolon = \A^{k - 1}v \ne \bs{0}$. Тогда $\A u = \A^kv = \bs{0}$, т.\,е. $u$ --- собственный вектор с собственным значением $0$. Пусть $\lambda \ne 0$ --- другое собственное значение, тогда по определению найдётся $w \ne \bs{0}: \A w = \lambda w$. Тогда $\bs{0} = \A^kw = \lambda^kw$. Отсюда $0 = \lambda^k$ и $\lambda = 0$.
        \item Если $\A$ диагонализируем, то на диагонали его диагональной матрицы стоят собственные значения, которые все нулевые в силу п.\,1. Следовательно, матрица нулевая и $\A = 0$.
        \item Из п.\,1 вытекает, что характеристический многочлен оператора $\A$ есть $(-t)^n$. Тогда $\A^k = 0$ по теореме Гамильтона "---Кэли.
    \end{enumerate}
\end{proof}

\begin{theorem}
    Пусть $\A: V \to V$ --- нильпотентный оператор. Тогда в пространстве $V$ существует базис, в котором матрица оператора $\A$ имеет блочно-диагональный вид с блоками из матриц вида
    $
    \begin{pmatrix}
        0 & 1 & & 0\\
        \vdots & \ddots & \ddots & \\
        0 & \cdots & 0 & 1
    \end{pmatrix}
    $ $(\ast)$ произвольных размеров. Такой вид матрицы оператора единственный с точностью до перестановки блоков.
\end{theorem}

\begin{definition}
    Базис, существование которого утверждается в этой теореме, называется \textit{нормальным}, а матрица оператора в таком базисе называется \textit{нормальным видом} (\textit{нормальной формой}) нильпотентного оператора.
\end{definition}

Впереди нас ждёт длинное и не очень увлекательное

\begin{proof}
    Базис, в котором матрица оператора состоит из блоков вида $(\ast)$, удобно изображать в виде диаграммы.

    \begin{wrapfigure}{l}{0.3\textwidth}
        \begin{asy}
            size(5cm);
            import geometry;

            pair a1 = (0, 3), b1 = (1, 3), c1 = (2, 2), d1 = (3, 2), e1 = (4, 1), f1 = (5, 0), g1 = (6, 0);
            pair a2 = (0, 2), b2 = (1, 2), c2 = (2, 1), d2 = (3, 1), e2 = (4, 0);
            pair a3 = (0, 1), b3 = (1, 1), c3 = (2, 0), d3 = (3, 0);
            pair a4 = (0, 0), b4 = (1, 0);

            draw(a1--a2, Arrow(HookHead, size=1mm));
            draw(a2--a3, Arrow(HookHead, size=1mm));
            draw(a3--a4, Arrow(HookHead, size=1mm));

            draw(b1--b2, Arrow(HookHead, size=1mm));
            draw(b2--b3, Arrow(HookHead, size=1mm));
            draw(b3--b4, Arrow(HookHead, size=1mm));

            draw(c1--c2, Arrow(HookHead, size=1mm));
            draw(c2--c3, Arrow(HookHead, size=1mm));

            draw(d1--d2, Arrow(HookHead, size=1mm));
            draw(d2--d3, Arrow(HookHead, size=1mm));

            draw(e1--e2, Arrow(HookHead, size=1mm));

            dot("${}$", a1, dir(0));
            dot("${}$", b1, dir(0));
            dot("${}$", c1, dir(0));
            dot("${}$", d1, dir(0));
            dot("${}$", e1, dir(0));
            dot("${}$", f1, dir(0));
            dot("${}$", g1, dir(0));

            dot("${}$", a2, dir(0));
            dot("${}$", b2, dir(0));
            dot("${}$", c2, dir(0));
            dot("${}$", d2, dir(0));
            dot("${}$", e2, dir(0));

            dot("${}$", a3, dir(0));
            dot("${}$", b3, dir(0));
            dot("${}$", c3, dir(0));
            dot("${}$", d3, dir(0));

            dot("${}$", a4, dir(0));
            dot("${}$", b4, dir(0));
        \end{asy}
    \end{wrapfigure}

    В этой диаграмме точки изображают элементы нормального базиса, а стрелки описывают действие оператора $\A$. Элементы нижней строки оператор переводит в нуль, т.\,е. в ней стоят собственные векторы оператора (с собственным значением $0$), входящие в базис. Каждый столбец соответствует одному блоку вида $(\ast)$, причём размер блока равен высоте столбца (количеству точек в нём). Итак, нам нужно доказать существование оператора, действие оператора $\A$ на элементы которого описывается диаграммой указанного вида. Проведём индукцию по размерности пространства $V$. Если $\dim V = 1$, то нильпотентный оператор $\A$ является нулевым, и любой ненулевой вектор в $V$ образует нормальный базис. Пусть теперь $\dim V = n > 1$, и пусть для размерностей, меньших $n$, существование нормального базиса уже доказано. Пусть $V_0 = \Ker\A$ --- подпространство собственных векторов для $\A$. Т.\,к. $\dim V > 0$, имеем $\dim V / V_0 < n$. Рассмотрим фактор-оператор $\widetilde{\A}: V / V_0 \to V / V_0$, $\widetilde{\A}(v + V_0) = \A v + V_0$. По индуктивному предположению $\widetilde{\A}$ имеет нормальный базис. Можно считать его непустым: иначе $V = V_0$ и любой базис в $V_0$ будет нормальным для $\A$. Построим диаграмму $\widetilde{D}$ для элементов нормального базиса оператора $\widetilde{\A}$, в каждом её столбце запишем самый верхний вектор $\widetilde{e}_i$, $i = 1, \ldots, m$ ($m$ --- количество столбцов в $\widetilde{D}$), и положим $\widetilde{e}_i = \vcentcolon e_i + V_0$, $e_i \in V$. Теперь построим диаграмму $D$ из векторов пространства $V$ следующим образом. Для $i = 1, \ldots, m$ столбец с номером $i$ будет состоять (сверху вниз) из векторов $e_i, \A e_i, \ldots, \A^{h_i - 1}e_i, \A^{h_i}e_i$, где $h_i$ --- высота $i$-го столбца в диаграмме $\widetilde{D}$. Т.\,к. $\widetilde{\A}^{h_i}\widetilde{e}_i = \bs{0}$, мы имеем $\A^{h_i}e_i \in V_0$ и $\A^{h_i + 1}e_i = \bs{0}$. Выберем базис в линейной оболочке $\langle \A^{h_1}e_1, \ldots, \A^{h_m}e_m \rangle \subseteq V_0$, дополним его до базиса $V_0$ и поставим дополняющие векторы в качестве новых столбцов (высоты $1$) в нижней строке диаграммы $D$; оператор $\A$ переводит их в нуль.

    Таким образом, построенная диаграмма $D$ из векторов пространства $V$ имеет в точности такой вид, как требуется для нормального базиса. Нужно лишь проверить, что векторы, составляющие диаграмму, действительно образуют базис в $V$. Сначала покажем, что векторы из $D$ порождают всё $V$. Пусть $v \in V$. Положим $\widetilde{v} \vcentcolon = v + V_0$. По предположению $\widetilde{v} = \sum\limits_{i = 1}^m\sum\limits_{j = 0}^{h_i - 1}\lambda_{ij}\widetilde{\A}^j\widetilde{e}_i$. Тогда $v - \sum\limits_{i = 1}^m\sum\limits_{j = 0}^{h_i - 1}\lambda_{ij}\A^je_i \in V_0$. Но все векторы $\A^je_i$, $j \leqslant h_i - 1$, лежит в строках диаграммы $D$, начиная со второй снизу, а подпространство $V_0$ порождено векторами из нижней строки $D$ по построению. Поэтому $v$ можно представить в виде линейной комбинации векторов из $D$.

    Теперь доказываем линейную независимость. Сначала докажем, что векторы нижней строки линейно независимы. Действительно, если некоторая их нетривиальная линейная комбинация равна нулю, то она должна иметь вид $\sum\limits_{i = 1}^m\lambda_i\A^{h_i}e_i = \bs{0}$, ибо остальные элементы нижней строки дополняют базис линейной оболочки $\langle \A^{h_1}e_1, \ldots, \A^{h_m}e_m \rangle$ до базиса $V_0$. Но все $h_i \geqslant 1$, поэтому $\A\br{\sum\limits_{i = 1}^m\lambda_i\A^{h_i - 1}e_i} = \bs{0}$, так что $\sum\limits_{i = 1}^m\lambda_i\A^{h_i - 1}e_i \in V_0$ и $\sum\limits_{i = 1}^m\lambda_i\widetilde{\A}^{h_i - 1}\widetilde{e}_i = \bs{0}$. Из последнего соотношения следует, что все $\lambda_i = 0$, т.\,к. векторы $\widetilde{A}^{h_i - 1}\widetilde{e}_i$ составляют нижнюю строку диаграммы $D$ и являются частью базиса $V / V_0$.

    Наконец, покажем, что если имеется любая нетривиальная линейная комбинация векторов $D$, равная нулю, то из неё можно получить нетривиальную линейную зависимость между векторами нижней строки $D$. Отметим самую верхнюю строку $D$, в которой имеются ненулевые коэффициенты этой линейной комбинации. Пусть номер этой строки (считая снизу) равен $h$. Применим к этой линейной комбинации оператор $\A^{h - 1}$. При этом её часть, лежащая в $h$-ой строке, перейдёт в нетривиальную линейную комбинацию элементов нижней строки, а остальные слагаемые обратятся в нулю. Это завершает доказательсвто существования нормального базиса.

    Теперь докажем единственность. Размеры блоков --- это высоты столбцов диаграммы. Если расположить столбцы, как на риснуке, в порядке убывания, то их высоты однозначно определяются, если известны длины строк в диаграмме, начиная с нижней, в порядке убывания. Из предыдущего рассуждения следует, что длина нижней строки равна $\dim V_0 = \dim\Ker\A$ и не зависит от выбора базиса. Длина второй снизу строки равна размерности ядра фактор-оператора $\widetilde{\A}$ в пространстве $V / \Ker\A$, т.\,е. $\dim\Ker\A^2 - \dim\Ker\A$, что также не зависит от выбора базиса. Продолжая далее, мы видим, что длина $k$-ой снизу строки равна размерности ядра фактор-оператора в пространстве $V / \Ker\A^{k - 1}$, т.\,е. $\dim\Ker\A^k - \dim\Ker\A^{k - 1}$. Это завершает доказательство единственности.
\end{proof}

